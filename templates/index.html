<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beam Summit Demo App</title>
    <link rel="icon" href="https://ospo.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F564f5dd3-32df-4e14-88fa-310d398be829%2Fb7278032-2c5b-49fa-ac8e-f888a8646bf2%2FBeam_Mascot.png?table=block&id=bd3ded46-63e2-4f67-bb87-f061f7cfdeff&spaceId=564f5dd3-32df-4f67-bb87-f061f7cfdeff&width=170&userId=&cache=v2">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <div class="row mt-5">
            <div class="col-md-12 text-center">
                <img src="https://ospo.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F564f5dd3-32df-4e14-88fa-310d398be829%2F15c5fdd5-6064-47de-8ed3-cbe50dde06ae%2FHeader_Sessionize_Beam_Summit_2024_tmp.png?table=block&id=548afb63-be56-4f0b-a824-b6de588c597a&spaceId=564f5dd3-32df-4e14-88fa-310d398be829&width=2000&userId=&cache=v2" class="img-fluid" alt="Beam Summit 2024">
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-md-12">
                <div class="alert alert-warning" role="alert">
                    Please note that this demo will send an <strong>ACTUAL email</strong> to the email address specified in the csv. It is YOUR ABSOLUTE RESPONSIBILITY to ensure that the email address (s) provided belong(s) to you. Please be responsible!!
                </div>
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-md-12 text-center">
                <h2>Upload Your CSV File</h2>
                <p>Prepare your upload file using this template: <a href="https://github.com/SadeeqAkintola/beam-summit-2024-airflow/blob/main/sample-input-file.csv" target="_blank">Download Template</a></p>
                <img src="https://ospo.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F564f5dd3-32df-4e14-88fa-310d398be829%2Fb7278032-2c5b-49fa-ac8e-f888a8646bf2%2FBeam_Mascot.png?table=block&id=bd3ded46-63e2-4f67-bb87-f061f7cfdeff&spaceId=564f5dd3-32df-4f67-bb87-f061f7cfdeff&width=170&userId=&cache=v2" alt="Beam Mascot" class="mb-3">
                <form method="POST" enctype="multipart/form-data">
                    <div class="form-group">
                        <input type="file" name="file" class="form-control-file" accept=".csv">
                    </div>
                    <button type="submit" class="btn btn-primary">Upload File</button>
                </form>
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-md-12">
                {% with messages = get_flashed_messages(with_categories=true) %}
                  {% if messages %}
                    {% for category, message in messages %}
                      <div class="alert alert-{{ category }}" role="alert">
                        {{ message }}
                      </div>
                    {% endfor %}
                  {% endif %}
                {% endwith %}
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-md-12">
                <h3>File Uploads</h3>
                <p>There are currently {{ file_count }} files in the bucket.</p>
                <ul class="list-group">
                    {% for file in files %}
                        <li class="list-group-item">{{ file }}</li>
                    {% endfor %}
                </ul>
                <button onclick="window.location.reload();" class="btn btn-secondary mt-3">Refresh Files</button>
                <p class="mt-3">{{ required_files }} more file(s) needed for Airflow to trigger the Beam pipeline.</p>
                <div class="alert alert-info mt-4" role="alert">
                    We have constrained the Airflow Trigger for this demo to ONLY fire once the number of files in the bucket reaches 5. Refresh the counter above to see the number of files currently in the bucket.
                </div>
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
